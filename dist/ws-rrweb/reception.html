<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>player</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.css">
  <script src="https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.js"></script>
    <script src="https://hcsy.gitee.io/htest/CDN/jquery-1.11.1.min.js"></script>
    <style>.pre li {
  clear: both;
  float: left;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 3px;
  margin-bottom: 15px;
  padding: 10px 15px;
}

button {
  height: 36px;
  width: 150px;
  border: 0;
  border-radius: 5px;
  line-height: 36px;
}

input[type="text"] {
  height: 36px;
  width: 200px;
  text-indent: 7px;
  line-height: 36px;
}

</style>
  </head>

  <body>
    <script>// function handlePlayer() {
//   var obj = localStorage.getItem("rrweb");
//   obj = JSON.parse(obj);
//   console.log(obj);
//   var replayer = new rrweb.Replayer(obj.events, {
//     liveMode: true,
//   });
//   replayer.play();
// }
var ws = new WebSocket("ws://localhost:3600");
const BUFFER_MS = 500;
const replayer = new rrweb.Replayer([], {
    liveMode: true
});
// 直播模式下延迟1s播放
replayer.startLive(Date.now() - BUFFER_MS);
// 建立到服务端 websocket 连接
// 当连接被打开时，
// 注册接收消息的处理函数
ws.onopen = function(event) {
    // 当有消息发过来时，
    // 就将消息放到显示元素上
    // 实时回放模式
    ws.onmessage = async function(event) {
        const data = await event.data.text();
        console.log(data, typeof data, "接收到服务端发送的消息");
        replayer.addEvent(JSON.parse(data));
    };
};

</script>
  <script src="/reception.aac11fd7.js"></script></body>
</html>
