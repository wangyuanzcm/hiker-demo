var buttonStartStuff,buttonClearOutput,outputElement,db,otherDB,interval,lastClickTime,started=!1,storageIndex=0;function onLoad(){buttonStartStuff||(buttonStartStuff=document.getElementById("start-btn")),buttonClearOutput||(buttonClearOutput=document.getElementById("clear-btn")),outputElement||(outputElement=document.getElementById("output")),buttonStartStuff.addEventListener("click",(function(){lastClickTime=(new Date).toString(),db&&db.transaction(addClick),openTheOtherDatabase(),started?(buttonStartStuff.innerHTML="Start Stuff",stopStuff()):(buttonStartStuff.innerHTML="Stop Stuff",startStuff()),started=!started})),buttonClearOutput.addEventListener("click",(function(){outputElement.innerHTML=""})),openTheDatabase()}function startStuff(){window.localStorage&&window.localStorage.clear(),storageIndex=0,interval=setInterval(intervalStuff,1e3)}function stopStuff(){clearInterval(interval)}function intervalStuff(){var t="Doing interval stuff at "+new Date;if(setTimeout((function(){console.log(t)}),333),window.localStorage){var e=t+" (local)";window.localStorage.setItem("item-"+storageIndex,e)}if(window.sessionStorage){e=t+" (session)";window.sessionStorage.setItem("item-"+storageIndex,e)}storageIndex++,output(t);var n=new XMLHttpRequest;n.open("GET","../test/demo.json",!0),n.send(),"function"==typeof fetch&&fetch("../test/demo.json")}function sqlSuccess(t,e){console.log("SQL Success!")}function sqlError(t,e){console.log("SQL Error "+e.code+": "+e.message)}function addClick(t){t.executeSql("insert into clicks (date) values (?)",[lastClickTime],null,sqlError)}function clearDatabase(t,e){t.executeSql("delete from clicks",null,null,sqlError)}function createDatabase(t){t.executeSql("create table if not exists clicks (id integer primary key, date text)",null,clearDatabase,sqlError)}function createDatabase_other(t){t.executeSql("create table if not exists clicks_other (id integer primary key, other text)",null,null,sqlError)}function openTheDatabase(){window.openDatabase&&(db=window.openDatabase("clicks_db","1.0","clicks_db",8192)).transaction(createDatabase)}function openTheOtherDatabase(){otherDB||window.openDatabase&&(otherDB=window.openDatabase("clicks_other_db","1.0","clicks_other_db",8192)).transaction(createDatabase_other)}function output(t){var e=document.createElement("div");e.innerHTML=t,outputElement.appendChild(e)}function logXhr(t){console.log("xhr: readyState: "+t.readyState)}function injectTarget(){var t=document.createElement("script");t.src="//"+location.host+location.pathname.replace("test/demo.html","")+"target.js",location.href.indexOf("embedded=true")>-1&&t.setAttribute("embedded","true"),location.href.indexOf("cdn=true")>-1&&t.setAttribute("cdn","https://cdn.jsdelivr.net/npm/chii/public"),document.head.appendChild(t)}
//# sourceMappingURL=index.4d310976.js.map
