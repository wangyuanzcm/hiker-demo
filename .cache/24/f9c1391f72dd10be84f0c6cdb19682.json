{"id":"d6sW","dependencies":[{"name":"/Users/wangyuan/local_workspace/hiker-demo/package.json","includedInParent":true,"mtime":1670147061051}],"generated":{"js":"\"use strict\";var e,t=document.getElementById(\"startBtn\"),n=document.getElementById(\"recordBtn\"),d=document.getElementById(\"downloadBtn\"),o=document.querySelector(\"video\"),i=!1,a=[];function c(e,t){document.querySelector(\"#msg\").innerHTML+=\"<p>\".concat(e,\"</p>\"),void 0!==t&&console.error(t)}function r(e){t.disabled=!0,o.srcObject=e,window.stream=e,e.getVideoTracks()[0].addEventListener(\"ended\",function(){c(\"用户停止了分享屏幕\"),t.disabled=!1,n.disabled=!0}),n.disabled=!1}function s(e){c(\"getDisplayMedia on err: \".concat(e.name),e)}function l(){i=!1,e.stop(),d.disabled=!1,n.textContent=\"开始录制\"}function u(){a=[];var t={mimeType:v()[0]};try{e=new MediaRecorder(window.stream,t)}catch(o){return void c(\"创建MediaRecorder出错: \".concat(JSON.stringify(o)))}n.textContent=\"停止录制\",i=!0,d.disabled=!0,e.onstop=function(e){c(\"录制停止了: \"+e)},e.ondataavailable=m,e.start(),c(\"录制开始 mediaRecorder: \"+e)}function m(e){console.log(\"handleDataAvailable\",e),e.data&&e.data.size>0&&a.push(e.data)}function v(){return[\"video/webm;codecs=vp9,opus\",\"video/webm;codecs=vp8,opus\",\"video/webm;codecs=h264,opus\",\"video/mp4;codecs=h264,aac\"].filter(function(e){return MediaRecorder.isTypeSupported(e)})}t.addEventListener(\"click\",function(){navigator.mediaDevices.getDisplayMedia({video:!0}).then(r,s)}),navigator.mediaDevices&&\"getDisplayMedia\"in navigator.mediaDevices?t.disabled=!1:c(\"getDisplayMedia is not supported\"),n.addEventListener(\"click\",function(){0==i?u():l()}),d.addEventListener(\"click\",function(){var e=new Blob(a,{type:\"video/webm\"}),t=window.URL.createObjectURL(e),n=document.createElement(\"a\");n.style.display=\"none\",n.href=t,n.download=\"录屏_\"+(new Date).getTime()+\".webm\",document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(t)},100)});"},"sourceMaps":{"js":{"mappings":[{"source":"js/main.js","original":{"line":5,"column":0},"generated":{"line":1,"column":0}},{"source":"js/main.js","original":{"line":7,"column":0},"generated":{"line":1,"column":13}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":12,"column":4},"generated":{"line":1,"column":17}},{"source":"js/main.js","name":"startBtn","original":{"line":7,"column":6},"generated":{"line":1,"column":19}},{"source":"js/main.js","name":"document","original":{"line":7,"column":17},"generated":{"line":1,"column":21}},{"source":"js/main.js","name":"getElementById","original":{"line":7,"column":26},"generated":{"line":1,"column":30}},{"source":"js/main.js","original":{"line":7,"column":41},"generated":{"line":1,"column":45}},{"source":"js/main.js","name":"recordBtn","original":{"line":8,"column":6},"generated":{"line":1,"column":57}},{"source":"js/main.js","name":"document","original":{"line":8,"column":18},"generated":{"line":1,"column":59}},{"source":"js/main.js","name":"getElementById","original":{"line":8,"column":27},"generated":{"line":1,"column":68}},{"source":"js/main.js","original":{"line":8,"column":42},"generated":{"line":1,"column":83}},{"source":"js/main.js","name":"downloadBtn","original":{"line":9,"column":6},"generated":{"line":1,"column":96}},{"source":"js/main.js","name":"document","original":{"line":9,"column":20},"generated":{"line":1,"column":98}},{"source":"js/main.js","name":"getElementById","original":{"line":9,"column":29},"generated":{"line":1,"column":107}},{"source":"js/main.js","original":{"line":9,"column":44},"generated":{"line":1,"column":122}},{"source":"js/main.js","name":"video","original":{"line":10,"column":6},"generated":{"line":1,"column":137}},{"source":"js/main.js","name":"document","original":{"line":10,"column":14},"generated":{"line":1,"column":139}},{"source":"js/main.js","name":"querySelector","original":{"line":10,"column":23},"generated":{"line":1,"column":148}},{"source":"js/main.js","original":{"line":10,"column":37},"generated":{"line":1,"column":162}},{"source":"js/main.js","name":"isRecording","original":{"line":13,"column":4},"generated":{"line":1,"column":171}},{"source":"js/main.js","original":{"line":13,"column":18},"generated":{"line":1,"column":174}},{"source":"js/main.js","name":"recordedBlobs","original":{"line":14,"column":4},"generated":{"line":1,"column":176}},{"source":"js/main.js","original":{"line":14,"column":20},"generated":{"line":1,"column":178}},{"source":"js/main.js","original":{"line":21,"column":0},"generated":{"line":1,"column":181}},{"source":"js/main.js","name":"showMsg","original":{"line":21,"column":9},"generated":{"line":1,"column":190}},{"source":"js/main.js","name":"msg","original":{"line":21,"column":17},"generated":{"line":1,"column":192}},{"source":"js/main.js","name":"error","original":{"line":21,"column":22},"generated":{"line":1,"column":194}},{"source":"js/main.js","name":"document","original":{"line":22,"column":19},"generated":{"line":1,"column":197}},{"source":"js/main.js","name":"querySelector","original":{"line":22,"column":28},"generated":{"line":1,"column":206}},{"source":"js/main.js","original":{"line":22,"column":42},"generated":{"line":1,"column":220}},{"source":"js/main.js","name":"innerHTML","original":{"line":23,"column":11},"generated":{"line":1,"column":228}},{"source":"js/main.js","name":"msg","original":{"line":23,"column":30},"generated":{"line":1,"column":239}},{"source":"js/main.js","name":"msg","original":{"line":23,"column":30},"generated":{"line":1,"column":245}},{"source":"js/main.js","name":"msg","original":{"line":23,"column":30},"generated":{"line":1,"column":252}},{"source":"js/main.js","original":{"line":23,"column":4},"generated":{"line":1,"column":254}},{"source":"js/main.js","original":{"line":24,"column":25},"generated":{"line":1,"column":267}},{"source":"js/main.js","name":"error","original":{"line":24,"column":15},"generated":{"line":1,"column":271}},{"source":"js/main.js","name":"console","original":{"line":25,"column":6},"generated":{"line":1,"column":274}},{"source":"js/main.js","name":"error","original":{"line":25,"column":14},"generated":{"line":1,"column":282}},{"source":"js/main.js","name":"error","original":{"line":25,"column":20},"generated":{"line":1,"column":288}},{"source":"js/main.js","original":{"line":30,"column":0},"generated":{"line":1,"column":291}},{"source":"js/main.js","name":"gotDisplayStream","original":{"line":30,"column":9},"generated":{"line":1,"column":300}},{"source":"js/main.js","name":"stream","original":{"line":30,"column":26},"generated":{"line":1,"column":302}},{"source":"js/main.js","name":"startBtn","original":{"line":31,"column":2},"generated":{"line":1,"column":305}},{"source":"js/main.js","name":"disabled","original":{"line":31,"column":11},"generated":{"line":1,"column":307}},{"source":"js/main.js","original":{"line":31,"column":22},"generated":{"line":1,"column":317}},{"source":"js/main.js","name":"video","original":{"line":32,"column":2},"generated":{"line":1,"column":319}},{"source":"js/main.js","name":"srcObject","original":{"line":32,"column":8},"generated":{"line":1,"column":321}},{"source":"js/main.js","name":"stream","original":{"line":32,"column":20},"generated":{"line":1,"column":331}},{"source":"js/main.js","name":"window","original":{"line":33,"column":2},"generated":{"line":1,"column":333}},{"source":"js/main.js","name":"stream","original":{"line":33,"column":9},"generated":{"line":1,"column":340}},{"source":"js/main.js","name":"stream","original":{"line":33,"column":18},"generated":{"line":1,"column":347}},{"source":"js/main.js","name":"stream","original":{"line":35,"column":2},"generated":{"line":1,"column":349}},{"source":"js/main.js","name":"getVideoTracks","original":{"line":35,"column":9},"generated":{"line":1,"column":351}},{"source":"js/main.js","original":{"line":35,"column":26},"generated":{"line":1,"column":368}},{"source":"js/main.js","name":"addEventListener","original":{"line":35,"column":29},"generated":{"line":1,"column":371}},{"source":"js/main.js","original":{"line":35,"column":46},"generated":{"line":1,"column":388}},{"source":"js/main.js","original":{"line":35,"column":55},"generated":{"line":1,"column":396}},{"source":"js/main.js","name":"showMsg","original":{"line":36,"column":4},"generated":{"line":1,"column":407}},{"source":"js/main.js","original":{"line":36,"column":12},"generated":{"line":1,"column":409}},{"source":"js/main.js","name":"startBtn","original":{"line":37,"column":4},"generated":{"line":1,"column":422}},{"source":"js/main.js","name":"disabled","original":{"line":37,"column":13},"generated":{"line":1,"column":424}},{"source":"js/main.js","original":{"line":37,"column":24},"generated":{"line":1,"column":434}},{"source":"js/main.js","name":"recordBtn","original":{"line":38,"column":4},"generated":{"line":1,"column":436}},{"source":"js/main.js","name":"disabled","original":{"line":38,"column":14},"generated":{"line":1,"column":438}},{"source":"js/main.js","original":{"line":38,"column":25},"generated":{"line":1,"column":448}},{"source":"js/main.js","name":"recordBtn","original":{"line":40,"column":2},"generated":{"line":1,"column":452}},{"source":"js/main.js","name":"disabled","original":{"line":40,"column":12},"generated":{"line":1,"column":454}},{"source":"js/main.js","original":{"line":40,"column":23},"generated":{"line":1,"column":464}},{"source":"js/main.js","original":{"line":43,"column":0},"generated":{"line":1,"column":466}},{"source":"js/main.js","name":"onErr","original":{"line":43,"column":9},"generated":{"line":1,"column":475}},{"source":"js/main.js","name":"error","original":{"line":43,"column":15},"generated":{"line":1,"column":477}},{"source":"js/main.js","name":"showMsg","original":{"line":44,"column":2},"generated":{"line":1,"column":480}},{"source":"js/main.js","name":"error","original":{"line":44,"column":37},"generated":{"line":1,"column":482}},{"source":"js/main.js","name":"error","original":{"line":44,"column":37},"generated":{"line":1,"column":509}},{"source":"js/main.js","name":"error","original":{"line":44,"column":37},"generated":{"line":1,"column":516}},{"source":"js/main.js","name":"name","original":{"line":44,"column":43},"generated":{"line":1,"column":518}},{"source":"js/main.js","name":"error","original":{"line":44,"column":51},"generated":{"line":1,"column":524}},{"source":"js/main.js","original":{"line":63,"column":0},"generated":{"line":1,"column":527}},{"source":"js/main.js","name":"stopRecord","original":{"line":63,"column":9},"generated":{"line":1,"column":536}},{"source":"js/main.js","name":"isRecording","original":{"line":64,"column":2},"generated":{"line":1,"column":540}},{"source":"js/main.js","original":{"line":64,"column":16},"generated":{"line":1,"column":543}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":65,"column":2},"generated":{"line":1,"column":545}},{"source":"js/main.js","name":"stop","original":{"line":65,"column":16},"generated":{"line":1,"column":547}},{"source":"js/main.js","name":"downloadBtn","original":{"line":66,"column":2},"generated":{"line":1,"column":554}},{"source":"js/main.js","name":"disabled","original":{"line":66,"column":14},"generated":{"line":1,"column":556}},{"source":"js/main.js","original":{"line":66,"column":25},"generated":{"line":1,"column":566}},{"source":"js/main.js","name":"recordBtn","original":{"line":67,"column":2},"generated":{"line":1,"column":568}},{"source":"js/main.js","name":"textContent","original":{"line":67,"column":12},"generated":{"line":1,"column":570}},{"source":"js/main.js","original":{"line":67,"column":26},"generated":{"line":1,"column":582}},{"source":"js/main.js","original":{"line":70,"column":0},"generated":{"line":1,"column":589}},{"source":"js/main.js","name":"startRecording","original":{"line":70,"column":9},"generated":{"line":1,"column":598}},{"source":"js/main.js","name":"recordedBlobs","original":{"line":71,"column":2},"generated":{"line":1,"column":602}},{"source":"js/main.js","original":{"line":71,"column":18},"generated":{"line":1,"column":604}},{"source":"js/main.js","original":{"line":72,"column":2},"generated":{"line":1,"column":607}},{"source":"js/main.js","name":"options","original":{"line":73,"column":8},"generated":{"line":1,"column":611}},{"source":"js/main.js","original":{"line":73,"column":18},"generated":{"line":1,"column":613}},{"source":"js/main.js","name":"mimeType","original":{"line":73,"column":20},"generated":{"line":1,"column":614}},{"source":"js/main.js","name":"getSupportedMimeTypes","original":{"line":72,"column":19},"generated":{"line":1,"column":623}},{"source":"js/main.js","original":{"line":72,"column":43},"generated":{"line":1,"column":627}},{"source":"js/main.js","original":{"line":75,"column":2},"generated":{"line":1,"column":631}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":76,"column":4},"generated":{"line":1,"column":635}},{"source":"js/main.js","original":{"line":76,"column":20},"generated":{"line":1,"column":637}},{"source":"js/main.js","name":"MediaRecorder","original":{"line":76,"column":24},"generated":{"line":1,"column":641}},{"source":"js/main.js","name":"window","original":{"line":76,"column":38},"generated":{"line":1,"column":655}},{"source":"js/main.js","name":"stream","original":{"line":76,"column":45},"generated":{"line":1,"column":662}},{"source":"js/main.js","name":"options","original":{"line":76,"column":53},"generated":{"line":1,"column":669}},{"source":"js/main.js","original":{"line":77,"column":4},"generated":{"line":1,"column":672}},{"source":"js/main.js","name":"e","original":{"line":77,"column":11},"generated":{"line":1,"column":678}},{"source":"js/main.js","original":{"line":79,"column":4},"generated":{"line":1,"column":681}},{"source":"js/main.js","name":"showMsg","original":{"line":78,"column":4},"generated":{"line":1,"column":693}},{"source":"js/main.js","name":"JSON","original":{"line":78,"column":34},"generated":{"line":1,"column":695}},{"source":"js/main.js","name":"JSON","original":{"line":78,"column":34},"generated":{"line":1,"column":717}},{"source":"js/main.js","name":"JSON","original":{"line":78,"column":34},"generated":{"line":1,"column":724}},{"source":"js/main.js","name":"stringify","original":{"line":78,"column":39},"generated":{"line":1,"column":729}},{"source":"js/main.js","name":"e","original":{"line":78,"column":49},"generated":{"line":1,"column":739}},{"source":"js/main.js","name":"recordBtn","original":{"line":81,"column":2},"generated":{"line":1,"column":744}},{"source":"js/main.js","name":"textContent","original":{"line":81,"column":12},"generated":{"line":1,"column":746}},{"source":"js/main.js","original":{"line":81,"column":26},"generated":{"line":1,"column":758}},{"source":"js/main.js","name":"isRecording","original":{"line":82,"column":2},"generated":{"line":1,"column":765}},{"source":"js/main.js","original":{"line":82,"column":16},"generated":{"line":1,"column":768}},{"source":"js/main.js","name":"downloadBtn","original":{"line":83,"column":2},"generated":{"line":1,"column":770}},{"source":"js/main.js","name":"disabled","original":{"line":83,"column":14},"generated":{"line":1,"column":772}},{"source":"js/main.js","original":{"line":83,"column":25},"generated":{"line":1,"column":782}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":84,"column":2},"generated":{"line":1,"column":784}},{"source":"js/main.js","name":"onstop","original":{"line":84,"column":16},"generated":{"line":1,"column":786}},{"source":"js/main.js","original":{"line":84,"column":25},"generated":{"line":1,"column":793}},{"source":"js/main.js","name":"event","original":{"line":84,"column":26},"generated":{"line":1,"column":802}},{"source":"js/main.js","name":"showMsg","original":{"line":85,"column":4},"generated":{"line":1,"column":805}},{"source":"js/main.js","original":{"line":85,"column":12},"generated":{"line":1,"column":807}},{"source":"js/main.js","name":"event","original":{"line":85,"column":24},"generated":{"line":1,"column":817}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":87,"column":2},"generated":{"line":1,"column":821}},{"source":"js/main.js","name":"ondataavailable","original":{"line":87,"column":16},"generated":{"line":1,"column":823}},{"source":"js/main.js","name":"handleDataAvailable","original":{"line":87,"column":34},"generated":{"line":1,"column":839}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":88,"column":2},"generated":{"line":1,"column":841}},{"source":"js/main.js","name":"start","original":{"line":88,"column":16},"generated":{"line":1,"column":843}},{"source":"js/main.js","name":"showMsg","original":{"line":89,"column":2},"generated":{"line":1,"column":851}},{"source":"js/main.js","original":{"line":89,"column":10},"generated":{"line":1,"column":853}},{"source":"js/main.js","name":"mediaRecorder","original":{"line":89,"column":35},"generated":{"line":1,"column":876}},{"source":"js/main.js","original":{"line":92,"column":0},"generated":{"line":1,"column":879}},{"source":"js/main.js","name":"handleDataAvailable","original":{"line":92,"column":9},"generated":{"line":1,"column":888}},{"source":"js/main.js","name":"event","original":{"line":92,"column":29},"generated":{"line":1,"column":890}},{"source":"js/main.js","name":"console","original":{"line":93,"column":2},"generated":{"line":1,"column":893}},{"source":"js/main.js","name":"log","original":{"line":93,"column":10},"generated":{"line":1,"column":901}},{"source":"js/main.js","original":{"line":93,"column":14},"generated":{"line":1,"column":905}},{"source":"js/main.js","name":"event","original":{"line":93,"column":37},"generated":{"line":1,"column":927}},{"source":"js/main.js","name":"event","original":{"line":94,"column":6},"generated":{"line":1,"column":930}},{"source":"js/main.js","name":"data","original":{"line":94,"column":12},"generated":{"line":1,"column":932}},{"source":"js/main.js","name":"event","original":{"line":94,"column":20},"generated":{"line":1,"column":938}},{"source":"js/main.js","name":"data","original":{"line":94,"column":26},"generated":{"line":1,"column":940}},{"source":"js/main.js","name":"size","original":{"line":94,"column":31},"generated":{"line":1,"column":945}},{"source":"js/main.js","original":{"line":94,"column":38},"generated":{"line":1,"column":950}},{"source":"js/main.js","name":"recordedBlobs","original":{"line":95,"column":4},"generated":{"line":1,"column":953}},{"source":"js/main.js","name":"push","original":{"line":95,"column":18},"generated":{"line":1,"column":955}},{"source":"js/main.js","name":"event","original":{"line":95,"column":23},"generated":{"line":1,"column":960}},{"source":"js/main.js","name":"data","original":{"line":95,"column":29},"generated":{"line":1,"column":962}},{"source":"js/main.js","original":{"line":102,"column":0},"generated":{"line":1,"column":968}},{"source":"js/main.js","name":"getSupportedMimeTypes","original":{"line":102,"column":9},"generated":{"line":1,"column":977}},{"source":"js/main.js","original":{"line":109,"column":2},"generated":{"line":1,"column":981}},{"source":"js/main.js","original":{"line":103,"column":24},"generated":{"line":1,"column":987}},{"source":"js/main.js","original":{"line":104,"column":4},"generated":{"line":1,"column":988}},{"source":"js/main.js","original":{"line":105,"column":4},"generated":{"line":1,"column":1017}},{"source":"js/main.js","original":{"line":106,"column":4},"generated":{"line":1,"column":1046}},{"source":"js/main.js","original":{"line":107,"column":4},"generated":{"line":1,"column":1076}},{"source":"js/main.js","name":"filter","original":{"line":109,"column":23},"generated":{"line":1,"column":1105}},{"source":"js/main.js","original":{"line":109,"column":30},"generated":{"line":1,"column":1112}},{"source":"js/main.js","name":"mimeType","original":{"line":109,"column":30},"generated":{"line":1,"column":1121}},{"source":"js/main.js","original":{"line":110,"column":4},"generated":{"line":1,"column":1124}},{"source":"js/main.js","name":"MediaRecorder","original":{"line":110,"column":11},"generated":{"line":1,"column":1131}},{"source":"js/main.js","name":"isTypeSupported","original":{"line":110,"column":25},"generated":{"line":1,"column":1145}},{"source":"js/main.js","name":"mimeType","original":{"line":110,"column":41},"generated":{"line":1,"column":1161}},{"source":"js/main.js","name":"startBtn","original":{"line":16,"column":0},"generated":{"line":1,"column":1166}},{"source":"js/main.js","name":"addEventListener","original":{"line":16,"column":9},"generated":{"line":1,"column":1168}},{"source":"js/main.js","original":{"line":16,"column":26},"generated":{"line":1,"column":1185}},{"source":"js/main.js","original":{"line":16,"column":35},"generated":{"line":1,"column":1193}},{"source":"js/main.js","name":"navigator","original":{"line":17,"column":2},"generated":{"line":1,"column":1204}},{"source":"js/main.js","name":"mediaDevices","original":{"line":17,"column":12},"generated":{"line":1,"column":1214}},{"source":"js/main.js","name":"getDisplayMedia","original":{"line":17,"column":25},"generated":{"line":1,"column":1227}},{"source":"js/main.js","original":{"line":17,"column":41},"generated":{"line":1,"column":1243}},{"source":"js/main.js","name":"video","original":{"line":17,"column":42},"generated":{"line":1,"column":1244}},{"source":"js/main.js","original":{"line":17,"column":49},"generated":{"line":1,"column":1251}},{"source":"js/main.js","name":"then","original":{"line":18,"column":7},"generated":{"line":1,"column":1255}},{"source":"js/main.js","name":"gotDisplayStream","original":{"line":18,"column":12},"generated":{"line":1,"column":1260}},{"source":"js/main.js","name":"onErr","original":{"line":18,"column":30},"generated":{"line":1,"column":1262}},{"source":"js/main.js","name":"navigator","original":{"line":49,"column":5},"generated":{"line":1,"column":1267}},{"source":"js/main.js","name":"mediaDevices","original":{"line":49,"column":15},"generated":{"line":1,"column":1277}},{"source":"js/main.js","original":{"line":49,"column":31},"generated":{"line":1,"column":1291}},{"source":"js/main.js","name":"navigator","original":{"line":49,"column":52},"generated":{"line":1,"column":1311}},{"source":"js/main.js","name":"mediaDevices","original":{"line":49,"column":62},"generated":{"line":1,"column":1321}},{"source":"js/main.js","name":"startBtn","original":{"line":50,"column":2},"generated":{"line":1,"column":1334}},{"source":"js/main.js","name":"disabled","original":{"line":50,"column":11},"generated":{"line":1,"column":1336}},{"source":"js/main.js","original":{"line":50,"column":22},"generated":{"line":1,"column":1346}},{"source":"js/main.js","name":"showMsg","original":{"line":52,"column":2},"generated":{"line":1,"column":1348}},{"source":"js/main.js","original":{"line":52,"column":10},"generated":{"line":1,"column":1350}},{"source":"js/main.js","name":"recordBtn","original":{"line":55,"column":0},"generated":{"line":1,"column":1386}},{"source":"js/main.js","name":"addEventListener","original":{"line":55,"column":10},"generated":{"line":1,"column":1388}},{"source":"js/main.js","original":{"line":55,"column":27},"generated":{"line":1,"column":1405}},{"source":"js/main.js","original":{"line":55,"column":36},"generated":{"line":1,"column":1413}},{"source":"js/main.js","original":{"line":56,"column":20},"generated":{"line":1,"column":1424}},{"source":"js/main.js","name":"isRecording","original":{"line":56,"column":5},"generated":{"line":1,"column":1427}},{"source":"js/main.js","name":"startRecording","original":{"line":57,"column":4},"generated":{"line":1,"column":1429}},{"source":"js/main.js","name":"stopRecord","original":{"line":59,"column":4},"generated":{"line":1,"column":1433}},{"source":"js/main.js","name":"downloadBtn","original":{"line":114,"column":0},"generated":{"line":1,"column":1439}},{"source":"js/main.js","name":"addEventListener","original":{"line":114,"column":12},"generated":{"line":1,"column":1441}},{"source":"js/main.js","original":{"line":114,"column":29},"generated":{"line":1,"column":1458}},{"source":"js/main.js","original":{"line":114,"column":38},"generated":{"line":1,"column":1466}},{"source":"js/main.js","original":{"line":115,"column":2},"generated":{"line":1,"column":1477}},{"source":"js/main.js","name":"blob","original":{"line":115,"column":8},"generated":{"line":1,"column":1481}},{"source":"js/main.js","original":{"line":115,"column":15},"generated":{"line":1,"column":1483}},{"source":"js/main.js","name":"Blob","original":{"line":115,"column":19},"generated":{"line":1,"column":1487}},{"source":"js/main.js","name":"recordedBlobs","original":{"line":115,"column":24},"generated":{"line":1,"column":1492}},{"source":"js/main.js","original":{"line":115,"column":39},"generated":{"line":1,"column":1494}},{"source":"js/main.js","name":"type","original":{"line":115,"column":41},"generated":{"line":1,"column":1495}},{"source":"js/main.js","original":{"line":115,"column":47},"generated":{"line":1,"column":1500}},{"source":"js/main.js","name":"url","original":{"line":116,"column":8},"generated":{"line":1,"column":1515}},{"source":"js/main.js","name":"window","original":{"line":116,"column":14},"generated":{"line":1,"column":1517}},{"source":"js/main.js","name":"URL","original":{"line":116,"column":21},"generated":{"line":1,"column":1524}},{"source":"js/main.js","name":"createObjectURL","original":{"line":116,"column":25},"generated":{"line":1,"column":1528}},{"source":"js/main.js","name":"blob","original":{"line":116,"column":41},"generated":{"line":1,"column":1544}},{"source":"js/main.js","name":"a","original":{"line":117,"column":8},"generated":{"line":1,"column":1547}},{"source":"js/main.js","name":"document","original":{"line":117,"column":12},"generated":{"line":1,"column":1549}},{"source":"js/main.js","name":"createElement","original":{"line":117,"column":21},"generated":{"line":1,"column":1558}},{"source":"js/main.js","original":{"line":117,"column":35},"generated":{"line":1,"column":1572}},{"source":"js/main.js","name":"a","original":{"line":118,"column":2},"generated":{"line":1,"column":1577}},{"source":"js/main.js","name":"style","original":{"line":118,"column":4},"generated":{"line":1,"column":1579}},{"source":"js/main.js","name":"display","original":{"line":118,"column":10},"generated":{"line":1,"column":1585}},{"source":"js/main.js","original":{"line":118,"column":20},"generated":{"line":1,"column":1593}},{"source":"js/main.js","name":"a","original":{"line":119,"column":2},"generated":{"line":1,"column":1600}},{"source":"js/main.js","name":"href","original":{"line":119,"column":4},"generated":{"line":1,"column":1602}},{"source":"js/main.js","name":"url","original":{"line":119,"column":11},"generated":{"line":1,"column":1607}},{"source":"js/main.js","name":"a","original":{"line":120,"column":2},"generated":{"line":1,"column":1609}},{"source":"js/main.js","name":"download","original":{"line":120,"column":4},"generated":{"line":1,"column":1611}},{"source":"js/main.js","original":{"line":120,"column":15},"generated":{"line":1,"column":1620}},{"source":"js/main.js","original":{"line":120,"column":23},"generated":{"line":1,"column":1627}},{"source":"js/main.js","name":"Date","original":{"line":120,"column":27},"generated":{"line":1,"column":1631}},{"source":"js/main.js","name":"getTime","original":{"line":120,"column":34},"generated":{"line":1,"column":1637}},{"source":"js/main.js","original":{"line":120,"column":46},"generated":{"line":1,"column":1647}},{"source":"js/main.js","name":"document","original":{"line":121,"column":2},"generated":{"line":1,"column":1655}},{"source":"js/main.js","name":"body","original":{"line":121,"column":11},"generated":{"line":1,"column":1664}},{"source":"js/main.js","name":"appendChild","original":{"line":121,"column":16},"generated":{"line":1,"column":1669}},{"source":"js/main.js","name":"a","original":{"line":121,"column":28},"generated":{"line":1,"column":1681}},{"source":"js/main.js","name":"a","original":{"line":122,"column":2},"generated":{"line":1,"column":1684}},{"source":"js/main.js","name":"click","original":{"line":122,"column":4},"generated":{"line":1,"column":1686}},{"source":"js/main.js","name":"setTimeout","original":{"line":123,"column":2},"generated":{"line":1,"column":1694}},{"source":"js/main.js","original":{"line":123,"column":13},"generated":{"line":1,"column":1705}},{"source":"js/main.js","name":"document","original":{"line":124,"column":4},"generated":{"line":1,"column":1716}},{"source":"js/main.js","name":"body","original":{"line":124,"column":13},"generated":{"line":1,"column":1725}},{"source":"js/main.js","name":"removeChild","original":{"line":124,"column":18},"generated":{"line":1,"column":1730}},{"source":"js/main.js","name":"a","original":{"line":124,"column":30},"generated":{"line":1,"column":1742}},{"source":"js/main.js","name":"window","original":{"line":125,"column":4},"generated":{"line":1,"column":1745}},{"source":"js/main.js","name":"URL","original":{"line":125,"column":11},"generated":{"line":1,"column":1752}},{"source":"js/main.js","name":"revokeObjectURL","original":{"line":125,"column":15},"generated":{"line":1,"column":1756}},{"source":"js/main.js","name":"url","original":{"line":125,"column":31},"generated":{"line":1,"column":1772}},{"source":"js/main.js","original":{"line":126,"column":5},"generated":{"line":1,"column":1776}}],"sources":{"js/main.js":"/*\n *  分享屏幕\n */\n\n'use strict';\n\nconst startBtn = document.getElementById('startBtn');\nconst recordBtn = document.getElementById('recordBtn');\nconst downloadBtn = document.getElementById('downloadBtn');\nconst video = document.querySelector('video'); // 预览用的\n\nlet mediaRecorder;\nlet isRecording = false;\nlet recordedBlobs = [];\n\nstartBtn.addEventListener('click', () => {\n  navigator.mediaDevices.getDisplayMedia({video: true})\n      .then(gotDisplayStream, onErr);\n});\n\nfunction showMsg(msg, error) {\n    const msgEle = document.querySelector('#msg');\n    msgEle.innerHTML += `<p>${msg}</p>`;\n    if (typeof error !== 'undefined') {\n      console.error(error);\n    }\n  }\n\n// 拿到屏幕数据流\nfunction gotDisplayStream(stream) {\n  startBtn.disabled = true;\n  video.srcObject = stream; // 显示出来\n  window.stream = stream;   // 缓存一下\n\n  stream.getVideoTracks()[0].addEventListener('ended', () => {\n    showMsg('用户停止了分享屏幕');\n    startBtn.disabled = false;\n    recordBtn.disabled = true;\n  });\n  recordBtn.disabled = false;\n}\n\nfunction onErr(error) {\n  showMsg(`getDisplayMedia on err: ${error.name}`, error);\n}\n\n\n\nif ((navigator.mediaDevices && 'getDisplayMedia' in navigator.mediaDevices)) {\n  startBtn.disabled = false;\n} else {\n  showMsg('getDisplayMedia is not supported');\n}\n\nrecordBtn.addEventListener('click', ()=> {\n  if(isRecording == false) {\n    startRecording();\n  } else {\n    stopRecord();\n  }\n});\n\nfunction stopRecord() {\n  isRecording = false;\n  mediaRecorder.stop();\n  downloadBtn.disabled = false;\n  recordBtn.textContent = \"开始录制\";\n}\n\nfunction startRecording() {\n  recordedBlobs = [];\n  const mimeType = getSupportedMimeTypes()[0];\n  const options = { mimeType };\n\n  try {\n    mediaRecorder = new MediaRecorder(window.stream, options);\n  } catch (e) {\n    showMsg(`创建MediaRecorder出错: ${JSON.stringify(e)}`);\n    return;\n  }\n  recordBtn.textContent = '停止录制';\n  isRecording = true;\n  downloadBtn.disabled = true;\n  mediaRecorder.onstop = (event) => {\n    showMsg('录制停止了: ' + event);\n  };\n  mediaRecorder.ondataavailable = handleDataAvailable;\n  mediaRecorder.start();\n  showMsg('录制开始 mediaRecorder: ' + mediaRecorder);\n}\n\nfunction handleDataAvailable(event) {\n  console.log('handleDataAvailable', event);\n  if (event.data && event.data.size > 0) {\n    recordedBlobs.push(event.data);\n  }\n}\n\n\n\n// 找到支持的格式\nfunction getSupportedMimeTypes() {\n  const possibleTypes = [\n    'video/webm;codecs=vp9,opus',\n    'video/webm;codecs=vp8,opus',\n    'video/webm;codecs=h264,opus',\n    'video/mp4;codecs=h264,aac',\n  ];\n  return possibleTypes.filter(mimeType => {\n    return MediaRecorder.isTypeSupported(mimeType);\n  });\n}\n\ndownloadBtn.addEventListener('click', () => {\n  const blob = new Blob(recordedBlobs, { type: 'video/webm' });\n  const url = window.URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.style.display = 'none';\n  a.href = url;\n  a.download = '录屏_' + new Date().getTime() + '.webm';\n  document.body.appendChild(a);\n  a.click();\n  setTimeout(() => {\n    document.body.removeChild(a);\n    window.URL.revokeObjectURL(url);\n  }, 100);\n});"},"lineCount":null}},"error":null,"hash":"04c1d83121c6d99315dbc382c2ce2453","cacheData":{"env":{}}}